!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e=15e3,t="required",n="length",r="type",o="range",i={REQUIRED:"$field$,输入值不可为空",LENGTH:"$field$,输入超长，最大长度为$rule$",TYPE:"$field$,输入的类型不正确，应为$rule$类型",RANGE:"$field$,输入不在范围内，应在$range1$~$range2$之内",LACK:"上送字段缺失，缺少字段$field$"},s="WEBFUNNY_COOKIE";function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function c(e,t){return e(t={exports:{}},t.exports),t.exports}var u=c((function(e){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0})),f=a(u);function l(e,t){var n,r=t||document;if(n=r.querySelectorAll,"undefined"!==f(n))return r.querySelectorAll("[".concat(e,"]"));for(var o=[],i=r.getElementsByTagName("*"),s=0,a=i.length;s<a;s++){var c=i[s];null!==c.getAttribute(e)&&o.push(c)}return o}function d(e,t,n){if(window){var r=localStorage,o={data:t,expires:n};if(r.WEBFUNNY_COOKIE){var i=JSON.parse(r.WEBFUNNY_COOKIE);i[e]=o,r.WEBFUNNY_COOKIE=JSON.stringify(i)}else{var a={};a[e]=o,r.WEBFUNNY_COOKIE=JSON.stringify(a)}}else{var c={data:t,expires:n},u=web.getStorageSync(s);if(u)u[e]=c,web.setStorageSync(s,u);else{var f={};f[e]=c,web.setStorageSync(s,f)}}}function h(e){if(window){var t=localStorage,n=null;if(t.WEBFUNNY_COOKIE){var r=(n=JSON.parse(t.WEBFUNNY_COOKIE))[e];if(!r)return"";var o=parseInt(r.expires,10);return(new Date).getTime()>o?(delete n[e],t.WEBFUNNY_COOKIE=JSON.stringify(n),""):r.data}return""}var i=web.getStorageSync(s);if(i){var a=i[e];if(!a)return"";var c=parseInt(a.expires,10);return(new Date).getTime()>c?(delete i[e],web.setStorageSync(s,i),""):a.data}return""}function p(){var e=(new Date).Format("yyyyMMddhhmmssS");return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))+"-"+e}function g(){var e=p(),t=h("monitorCustomerKey");t||(d("monitorCustomerKey",e,(new Date).getTime()+31104e7),t=e);return t}function w(t){var n=(new Date).getTime(),r=h("lastHearBeatTime");r&&1!==t||(d("lastHearBeatTime",n,n+e+5e3),r=n);return r}function m(e){var t="";if(window){var n=localStorage;if(!e)return"";t=(n.wmUserInfo?JSON.parse(n.wmUserInfo):{})[e]}else{if(!e)return"";var r=web.getStorageSync("wmUserInfo");t=(r?JSON.parse(r):{})[e]}return t||""}Date.prototype.Format||(Date.prototype.Format=function(e){var t=e,n={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t});var v={isString:function(e){return"[object String]"===Object.prototype.toString.apply(e)},isNumber:function(e){return"[object Number]"===Object.prototype.toString.apply(e)},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isObject:function(e){return"[object Object]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},isBoolean:function(e){return"[object Boolean]"===Object.prototype.toString.apply(e)},getUuid:p,getWfCookie:h,setWfCookie:d,combineObject:function(e,t){return Object.assign(e,t)},getCustomerKey:g,getLastHeartBeatTime:w,getWeUserInfo:m,setFirstActionTime:function(e){for(var t=h("weFunnelConfig").funnelList,n=void 0===t?[]:t,r=0;r<n.length;r++){var o=n[r],i=o.s,s=void 0===i?"":i,a=o.c,c=void 0===a?"":a,u=o.t,f=void 0===u?1:u,l=(new Date).getTime()+24*f*3600*1e3;if(-1!==s.indexOf(1*e)){var p=(new Date).Format("yyyyMMdd");d("".concat(c,"-FirstStepDay"),"".concat(c,"-").concat(p),l)}}},getFirstActionTime:function(e){for(var t=h("weFunnelConfig").funnelList,n=void 0===t?[]:t,r="",o=0;o<n.length;o++){var i=n[o],s=i.s,a=void 0===s?"":s,c=i.c,u=void 0===c?"":c;-1!==a.indexOf(1*e)&&(r+=h("".concat(u,"-FirstStepDay"))+",")}return r}};function y(e,t){var n=!1,r=function(e,t){var n={success:!1,field:""};for(var r in t){if(!Object.prototype.hasOwnProperty.call(e,r))return n.success=!1,n.field=r,n;n.success=!0}return n}(e,t),o=r.success,s=r.field;if(!(n=o)){var a=i.LACK.replace(/\$field\$/g,s);return console.warn(a),n}for(var c in t){if(!(n=b(e[c],c,t[c])))return n}return n}function b(e,s,a){var c=!1;for(var u in a){var f=a[u];if(u===t&&f){if(!(c=void 0!==e)){var l=i.REQUIRED.replace(/\$field\$/g,s).replace(/\$rule\$/g,"");return console.warn(l),c}}else if(u===n&&f){if(!(c=e.toString().length<=f)){var d=i.LENGTH.replace(/\$field\$/g,s).replace(/\$rule\$/g,f);return console.warn(d),c}}else if(u===r&&f){if(!(c=(0,v["is"+f])(e))){var h=i.TYPE.replace(/\$field\$/g,s).replace(/\$rule\$/g,f);return console.warn(h),c}}else if(u===o&&f){var p=e>=f[0]&&e<f[1];if(!p){var g=i.RANGE.replace(/\$field\$/g,s).replace(/\$range1\$/g,f[0]).replace(/\$range2\$/g,f[1]);return console.warn(g),p}}}return c}var O="$$$webfunny-event-domain$$$",x="";x=window&&0===O.length?window.location.origin:O;var E={trackUrl:"".concat(x,"/tracker/upEvent"),eventDomain:x,requestMethod:"POST"};function _(){var e=E.trackUrl;if(window){var t=window.location.protocol;return t=t.replace(/file/g,"http"),e.indexOf("http")>-1?e:t+e}return e}function T(){var e=E.eventDomain;if(window){var t=window.location.protocol;return t=t.replace(/file/g,"http"),e.indexOf("http")>-1?e:t+e}return e}function I(e,t,n){var r=_();try{var o=window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");o.open("POST",r,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.onreadystatechange=function(){if(4==o.readyState){var e={};try{e=o.responseText?JSON.parse(o.responseText):{}}catch(t){e={}}"function"==typeof t&&t(e)}},o.onerror=function(){"function"==typeof n&&n()},o.send("data="+JSON.stringify(e))}catch(t){!function(e){var t=_(),n=t+(t.indexOf("?")<0?"?":"&")+e;new Image(1,1).src=n}(e)}}function S(e,t,n,r,o){if(window)try{var i=window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");i.open(e,t,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState){var e={};try{e=i.responseText?JSON.parse(i.responseText):{}}catch(t){e={}}"function"==typeof r&&r(e)}},i.onerror=function(){"function"==typeof o&&o()};var s="";for(var a in n)s+="".concat(a,"=").concat(n[a]);i.send(s)}catch(e){}}function N(e){if(window&&e)I(e,(function(e){v.setWfCookie("weFunnelConfig",{funnelList:e.data},(new Date).getTime()+864e5)}),(function(e){console.log(e)}));else if(e){var t=E.trackUrl;web.request({url:t,data:e,method:"POST",header:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},success:function(e){v.setWfCookie("weFunnelConfig",{funnelList:e.data},(new Date).getTime()+864e5)}})}}!function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=function(e){for(var t=window.document,n=o(t);n;)n=o(t=n.ownerDocument);return t}(),t=[],n=null,r=null;s.prototype.THROTTLE_TIMEOUT=100,s.prototype.POLL_INTERVAL=null,s.prototype.USE_MUTATION_OBSERVER=!0,s._setupCrossOriginUpdater=function(){return n||(n=function(e,n){r=e&&n?l(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach((function(e){e._checkForIntersections()}))}),n},s._resetCrossOriginUpdater=function(){n=null,r=null},s.prototype.observe=function(e){if(!this._observationTargets.some((function(t){return t.element==e}))){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},s.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter((function(t){return t.element!=e})),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},s.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},s.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},s.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter((function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]}))},s.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map((function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}}));return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},s.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var r=this._checkForIntersections,i=null,s=null;this.POLL_INTERVAL?i=n.setInterval(r,this.POLL_INTERVAL):(a(n,"resize",r,!0),a(t,"scroll",r,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(s=new n.MutationObserver(r)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push((function(){var e=t.defaultView;e&&(i&&e.clearInterval(i),c(e,"resize",r,!0)),c(t,"scroll",r,!0),s&&s.disconnect()}));var u=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=u){var f=o(t);f&&this._monitorIntersections(f.ownerDocument)}}},s.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var r=this.root&&(this.root.ownerDocument||this.root)||e,i=this._observationTargets.some((function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=r;){var i=o(n);if((n=i&&i.ownerDocument)==t)return!0}return!1}));if(!i){var s=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),s(),t!=r){var a=o(t);a&&this._unmonitorIntersections(a.ownerDocument)}}}},s.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},s.prototype._checkForIntersections=function(){if(this.root||!n||r){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(r){var o=r.element,s=u(o),a=this._rootContainsTarget(o),c=r.entry,f=e&&a&&this._computeTargetAndRootIntersection(o,s,t),l=null;this._rootContainsTarget(o)?n&&!this.root||(l=t):l={top:0,bottom:0,left:0,right:0,width:0,height:0};var d=r.entry=new i({time:window.performance&&performance.now&&performance.now(),target:o,boundingClientRect:s,rootBounds:l,intersectionRect:f});c?e&&a?this._hasCrossedThreshold(c,d)&&this._queuedEntries.push(d):c&&c.isIntersecting&&this._queuedEntries.push(d):this._queuedEntries.push(d)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},s.prototype._computeTargetAndRootIntersection=function(t,o,i){if("none"!=window.getComputedStyle(t).display){for(var s,a,c,f,d,p,g,w,m=o,v=h(t),y=!1;!y&&v;){var b=null,O=1==v.nodeType?window.getComputedStyle(v):{};if("none"==O.display)return null;if(v==this.root||9==v.nodeType)if(y=!0,v==this.root||v==e)n&&!this.root?!r||0==r.width&&0==r.height?(v=null,b=null,m=null):b=r:b=i;else{var x=h(v),E=x&&u(x),_=x&&this._computeTargetAndRootIntersection(x,E,i);E&&_?(v=x,b=l(E,_)):(v=null,m=null)}else{var T=v.ownerDocument;v!=T.body&&v!=T.documentElement&&"visible"!=O.overflow&&(b=u(v))}if(b&&(s=b,a=m,c=void 0,f=void 0,d=void 0,p=void 0,g=void 0,w=void 0,c=Math.max(s.top,a.top),f=Math.min(s.bottom,a.bottom),d=Math.max(s.left,a.left),p=Math.min(s.right,a.right),w=f-c,m=(g=p-d)>=0&&w>=0&&{top:c,bottom:f,left:d,right:p,width:g,height:w}||null),!m)break;v=v&&h(v)}return m}},s.prototype._getRootRect=function(){var t;if(this.root&&!p(this.root))t=u(this.root);else{var n=p(this.root)?this.root:e,r=n.documentElement,o=n.body;t={top:0,left:0,right:r.clientWidth||o.clientWidth,width:r.clientWidth||o.clientWidth,bottom:r.clientHeight||o.clientHeight,height:r.clientHeight||o.clientHeight}}return this._expandRectByRootMargin(t)},s.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map((function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100})),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},s.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,r=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==r)for(var o=0;o<this.thresholds.length;o++){var i=this.thresholds[o];if(i==n||i==r||i<n!=i<r)return!0}},s.prototype._rootIsInDom=function(){return!this.root||d(e,this.root)},s.prototype._rootContainsTarget=function(t){var n=this.root&&(this.root.ownerDocument||this.root)||e;return d(n,t)&&(!this.root||n==t.ownerDocument)},s.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},s.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=s,window.IntersectionObserverEntry=i}function o(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function i(e){this.time=e.time,this.target=e.target,this.rootBounds=f(e.rootBounds),this.boundingClientRect=f(e.boundingClientRect),this.intersectionRect=f(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,r=this.intersectionRect,o=r.width*r.height;this.intersectionRatio=n?Number((o/n).toFixed(4)):this.isIntersecting?1:0}function s(e,t){var n,r,o,i=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(i.root&&1!=i.root.nodeType&&9!=i.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),r=this.THROTTLE_TIMEOUT,o=null,function(){o||(o=setTimeout((function(){n(),o=null}),r))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(i.rootMargin),this.thresholds=this._initThresholds(i.threshold),this.root=i.root||null,this.rootMargin=this._rootMarginValues.map((function(e){return e.value+e.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function a(e,t,n,r){"function"==typeof e.addEventListener?e.addEventListener(t,n,r||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function c(e,t,n,r){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,r||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function u(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function f(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function l(e,t){var n=t.top-e.top,r=t.left-e.left;return{top:n,left:r,height:t.height,width:t.width,bottom:n+t.height,right:r+t.width}}function d(e,t){for(var n=t;n;){if(n==e)return!0;n=h(n)}return!1}function h(t){var n=t.parentNode;return 9==t.nodeType&&t!=e?o(t):(n&&n.assignedSlot&&(n=n.assignedSlot.parentNode),n&&11==n.nodeType&&n.host?n.host:n)}function p(e){return e&&9===e.nodeType}}(),window&&null==Element.prototype.getAttributeNames&&(Element.prototype.getAttributeNames=function(){for(var e=this.attributes,t=e.length,n=new Array(t),r=0;r<t;r++)n[r]=e[r].name;return n});var $=function(e,t){if("function"==typeof e.getAttributeNames&&e.getAttributeNames().indexOf(t)>-1)return!0},R=function(e){return!!Object.prototype.hasOwnProperty.call(e.dataset,"webfunnyExposureEle")},C=a(c((function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0}))),M=function(){var e=g(),t=m("userId"),n=function(){if(window){var e={},t=navigator.userAgent,n=t.match(/(Android);?[\s\/]+([\d.]+)?/),r=t.match(/(iPad).*OS\s([\d_]+)/),o=!r&&t.match(/(iPhone\sOS)\s([\d_]+)/),i=t.match(/Android\s[\S\s]+Build\//),s=window.screen.width,a=window.screen.height;if(e.ios=e.android=e.iphone=e.ipad=e.androidChrome=!1,e.isWeixin=/MicroMessenger/i.test(t),e.os="web",e.deviceName="PC",e.deviceSize=s+"×"+a,e.platform=navigator.platform,n&&(e.os="android",e.osVersion=n[2],e.android=!0,e.androidChrome=t.toLowerCase().indexOf("chrome")>=0),(r||o)&&(e.os="ios",e.ios=!0),o&&(e.osVersion=o[2].replace(/_/g,"."),e.iphone=!0),r&&(e.osVersion=r[2].replace(/_/g,"."),e.ipad=!0),e.ios&&e.osVersion&&t.indexOf("Version/")>=0&&"10"===e.osVersion.split(".")[0]&&(e.osVersion=t.toLowerCase().split("version/")[1].split(" ")[0]),e.iphone){var c="".concat(s," x ").concat(a);320===s&&480===a?c="4":320===s&&568===a?c="5/SE":375===s&&667===a?c="6/7/8":414===s&&736===a?c="6/7/8 Plus":375===s&&812===a?c="X/S/Max":414===s&&896===a?c="11/Pro-Max":375===s&&812===a?c="11-Pro/mini":390===s&&844===a?c="12/13/Pro":428===s&&926===a&&(c="12/13/Pro-Max"),e.deviceName="iphone "+c}else if(e.ipad)e.deviceName="ipad";else if(i){for(var u=i[0].split(";"),f="",l=0;l<u.length;l++)-1!=u[l].indexOf("Build")&&(f=u[l].replace(/Build\//g,""));""==f&&(f=u[1]),e.deviceName=f.replace(/(^\s*)|(\s*$)/g,"")}if(-1==t.indexOf("Mobile")){var d=navigator.userAgent.toLowerCase();e.browserName="其他";var h="";d.indexOf("msie")>0?(h=d.match(/msie [\d.]+;/gi)[0],e.browserName="ie",e.browserVersion=h.split("/")[1]):d.indexOf("edg")>0?(h=d.match(/edg\/[\d.]+/gi)[0],e.browserName="edge",e.browserVersion=h.split("/")[1]):d.indexOf("firefox")>0?(h=d.match(/firefox\/[\d.]+/gi)[0],e.browserName="firefox",e.browserVersion=h.split("/")[1]):d.indexOf("safari")>0&&d.indexOf("chrome")<0?(h=d.match(/safari\/[\d.]+/gi)[0],e.browserName="safari",e.browserVersion=h.split("/")[1]):d.indexOf("chrome")>0&&(h=d.match(/chrome\/[\d.]+/gi)[0],e.browserName="chrome",e.browserVersion=h.split("/")[1],d.indexOf("360se")>0&&(e.browserName="360"))}return{deviceName:e.deviceName,system:"".concat(e.os," ").concat(e.osVersion||""),os:e.os,platform:e.platform,browserName:e.browserName}}var p=web.getSystemInfoSync()||{},g=p.model,w=p.system,m=p.platform,v="",y=w.split(" ");return y.length>1&&(v=y[0]),{deviceName:g,system:w,os:v,platform:m}}(),r=n.deviceName,o=void 0===r?"":r,i=n.system,s=void 0===i?"":i,a=n.os,c=void 0===a?"":a,u=n.platform,f=void 0===u?"":u,l=n.browserName,d=void 0===l?"":l,p=function(){var e="";if(window)e=window?window.location.href.split("?")[0]:"";else if(getCurrentPages){var t=getCurrentPages();t.length>0&&(e=getCurrentPages()[t.length-1].route)}return e}(),w=m("platform");return{weCustomerKey:e,weUserId:t,wePath:p,weDeviceName:o,wePlatform:w||f,weSystem:s,weOs:c,weBrowserName:d,weNewStatus:function(){var e=h("monitorCustomerKey");if(e){var t="",n=e?e.match(/\d{14}/g):[];if(n&&n.length>0){var r=n[0].match(/\d{2}/g);t=r[0]+r[1]+"-"+r[2]+"-"+r[3]===(new Date).Format("yyyy-MM-dd")?1:2}}else t=1;return t}()}};function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e){var t=j(j({projectId:"$$$projectId$$$"},M()),e);"function"!=typeof navigator.sendBeacon||navigator.sendBeacon(E.trackUrl,JSON.stringify(t))},L=null,U={},A=[],F="_webfunny-eo",k="_webfunny-ce",B=function(){var e=document.getElementsByTagName("*");Array.prototype.forEach.call(e,(function(e,t){if($(e,F)){A.push(e);var n=e.getAttribute(F);n&&(r=e,o=t,Object.prototype.hasOwnProperty.call(r.dataset,"exposureKey".concat(o))||(r.dataset["exposureKey".concat(o)]=""),Object.defineProperty(U,"data-exposure-key".concat(t),{value:JSON.parse(n),configureable:!0,writable:!0,enumerable:!0}))}var r,o})),A=A.reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[])},V=function(){B(),A.forEach((function(e){var t;R(e)||(t=e,Object.prototype.hasOwnProperty.call(t.dataset,"webfunnyExposureEle")||(t.dataset.webfunnyExposureEle=""),q(e))}))};function H(e){if(Object.prototype.hasOwnProperty.call(e,"pointId")){var t=e.pointId;Object.prototype.hasOwnProperty.call(window._webfunnyEvent,t)?(delete e.pointId,window._webfunnyEvent[t].trackEvent(e)):console.warn("请检查pointId上送的值是否正确")}else console.warn("pointId为必须上送字段，请检查是否正确上送")}var q=function(e){var t=0;if($(e,"_webfunny-eo-ratio")){var n=e.getAttribute("_webfunny-eo-ratio");t=Object.is(n,"0")?0:parseFloat(n)}new IntersectionObserver((function(t,n){t.forEach((function(t){if(t.intersectionRatio>0){var r=Object.keys(e.dataset).find((function(e){if(e.indexOf("exposureKey")>-1)return e}));if(r){var o="data-exposure-key"+r.slice(11);H(U[o])}else console.warn("曝光需要上送对应数据");n.disconnect()}}))}),{root:null,rootMargin:"0px",threshold:t}).observe(e)};var W=function(){L||(L=setInterval((function(){if(!window||!document||!0!==document.hidden){var t=w(),n=(new Date).getTime(),r=n-t;if(!(r<0)&&r+500>=e){var o={stayTime:r/1e3};if(web.webfunnyEvent){web.webfunnyEvent("$$$HeartBeatPointId$$$").trackEvent(o);var i=n+e+5e3;v.setWfCookie("lastHearBeatTime",n,i)}}}}),e)),window&&window.addEventListener("beforeunload",(function(){var e=w(),t=(new Date).getTime();P({stayTime:t-e})})),V(),new MutationObserver((function(e){for(var t=0,n=e.length;t<n;t++)e[t].addedNodes[0]&&$(e[t].addedNodes[0],F)&&V(),e[t].target.querySelector("[".concat(F,"]"))&&(R(e[t].target.querySelector("[".concat(F,"]")))||V()),e[t].attributeName===F&&e[t].target.attributes[F]&&V()})).observe(document.documentElement,{childList:!0,attributes:!0,subtree:!0}),setTimeout((function(){for(var e,t,n,r=l(k),o=0,i=r.length;o<i;o++)t="click",n=function(e){var t=e.target.getAttribute(k);t?H(JSON.parse(t)):console.warn("曝光需要上送对应数据")},(e=r[o]).addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}),500)};!function(e){try{v.getWfCookie("weFunnelConfig")||S("post",T()+"/tracker/initCf",{projectId:"$$$projectId$$$"},(function(e){v.setWfCookie("weFunnelConfig",{funnelList:e.data},(new Date).getTime()+864e5)}),(function(){})),v&&(e.webfunnyEventUtils=v,e.webfunnyEventGetCustomerInfo=M,e.webfunnyEventUtils.getCustomerKey(),e.webfunnyEventUtils.getLastHeartBeatTime(1)),y&&N&&(e.webfunnyEventValidateParams=y,e.webfunnyEventSendRequest=N,e._webfunnyEvent="$$$webfunny-event-code$$$"),W()}catch(e){console.warn(e)}}(window||global)}));
